<!DOCTYPE html>
<html>
<<<<<<< Updated upstream
  <head>
    <meta charset="utf-8" />
    <title>13支-比牌環節</title>
    <style>
      body {
        background-image: url("imgs/牌桌.png");
        background-repeat: no-repeat;
        background-size: cover;
      }
      #compare {
        position: absolute;
        width: 15%;
        top: 38%;
        left: 42.5%;
      }
    </style>
  </head>
  <body>
    <img src="imgs/比較1.png" onclick="COMPARE()" id="compare" />
    <script>
      let data = {};
      let queryString = window.location.search; // 獲得網址字串
      let A1 = new Array(3),
        A2 = new Array(5),
        A3 = new Array(5); //玩家1
      let p2 = new Array(16);
      let B1 = new Array(3),
        B2 = new Array(5),
        B3 = new Array(5); //玩家2
      let p3 = new Array(16);
      let C1 = new Array(3),
        C2 = new Array(5),
        C3 = new Array(5); //玩家3
      let p4 = new Array(16);
      let D1 = new Array(3),
        D2 = new Array(5),
        D3 = new Array(5); //玩家4
      let now = 1;
      function getdata() {
        queryString = queryString.substring(1); // 去除問號
        queryString.split("&").forEach(function (keyValue) {
          // 把資料放到data
          var parts = keyValue.split("=");
          data[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);
        });
        //key1:頭墩//key2:二道//key3:尾墩//key4:玩家2//key5:玩家3//key6:玩家4//key7:當前局數
        A1 = data.key1.split(",");
        for (let i = 0; i <= 2; i++) {
          A1[i] = parseInt(A1[i]);
        }
        A2 = data.key2.split(",");
        for (let i = 0; i <= 4; i++) {
          A2[i] = parseInt(A2[i]);
        }
        A3 = data.key3.split(",");
        for (let i = 0; i <= 4; i++) {
          A3[i] = parseInt(A3[i]);
        }
        console.log(A1);
        console.log(A2);
        console.log(A3); //測試用
        p2 = data.key4.split(",");
        p3 = data.key5.split(",");
        p4 = data.key6.split(",");
        for (let i = 0; i <= 15; i++) {
          p2[i] = parseInt(p2[i]);
        }
        for (let i = 0; i <= 15; i++) {
          p3[i] = parseInt(p3[i]);
        }
        for (let i = 0; i <= 15; i++) {
          p4[i] = parseInt(p4[i]);
        }
        AI(p2);
        AI(p3);
        AI(p4);
      }
      function COMPARE() {
        //Step1:先得到牌型Step2:比牌型Step3:比同牌型大小
        switch (now) {
          case 1: //比較頭墩
            head();
            break;
          case 2: //比較二道
            mid();
            break;
          case 3: //比較尾墩
            tail();
            break;
        }
      }
      function AI(AIarray) {
        //五枚>同花順>彩金鐵支>鐵支>彩金葫蘆>葫蘆>對子同花>同花>順子>彩金三條>三條>兩對<一對>烏龍
        //頭:衝三++
        //二道:彩金三條、彩金葫蘆、鐵支、同花順、彩金鐵支、五枚++
        //尾:同二道
        //AI配牌
        console.log(AIarray);
      }
      document.addEventListener("load", getdata(), false); //載入完網頁後讀數據
    </script>
  </body>
</html>
=======
    <head>
        <meta charset="utf-8">
        <title>13支-比牌環節</title>
        <style>
            body {
                background-image: url("imgs/牌桌.png");
                background-repeat:no-repeat;
                background-size:cover;
            }
            #compare{
                position:absolute;
                width:15%;
                top:38%;
                left:42.5%;
            }
        </style>
    </head >
    <body>
        <img onclick="COMPARE()" id="compare"/>
        <script>
            let data = {};
            let queryString = window.location.search;// 獲得網址字串
            let A1 = new Array(3), A2 = new Array(5), A3 = new Array(5);//玩家1
            let p2 = new Array(16);
            let B1 = new Array(3), B2 = new Array(5), B3 = new Array(5);//玩家2
            let p3 = new Array(16);
            let C1 = new Array(3), C2 = new Array(5), C3 = new Array(5);//玩家3
            let p4 = new Array(16);
            let D1 = new Array(3), D2 = new Array(5), D3 = new Array(5);//玩家4
            let now = 1;
            let sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            let now = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            function getdata() {                             
                queryString = queryString.substring(1);// 去除問號                         
                queryString.split("&").forEach(function (keyValue) {// 把資料放到data  
                    var parts = keyValue.split("=");
                    data[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);
                });
                //key1:頭墩//key2:二道//key3:尾墩//key4:玩家2//key5:玩家3//key6:玩家4//key7:當前局數
                A1 = data.key1.split(',');
                for (let i = 0; i <= 2; i++) { A1[i] = parseInt(A1[i]) }
                A2 = data.key2.split(',');
                for (let i = 0; i <= 4; i++) { A2[i] = parseInt(A2[i]) }
                A3 = data.key3.split(',');
                for (let i = 0; i <= 4; i++) { A3[i] = parseInt(A3[i]) }
                console.log(A1); console.log(A2); console.log(A3);//測試用
                p2 = data.key4.split(',');
                p3 = data.key5.split(',');
                p4 = data.key6.split(',');
                now = parseInt(data.key7);
                document.getElementById("compare").src = "imgs/比較" + now + ".png";
                for (let i = 0; i <= 15; i++) { p2[i] = parseInt(p2[i]) }
                for (let i = 0; i <= 15; i++) { p3[i] = parseInt(p3[i]) }
                for (let i = 0; i <= 15; i++) { p4[i] = parseInt(p4[i]) }
                AI(p2, B1, B2, B3);
                AI(p3, C1, C2, C3);
                AI(p4, D1, D2, D3);
            }
            function head() {

            }
            function mid() {

            }
            function tail() {

            }
            function COMPARE() {//Step1:先得到牌型Step2:比牌型Step3:比同牌型大小
                switch (now) {
                    case 1://比較頭墩
                        head();
                        break;
                    case 2://比較二道
                        mid();
                        break;
                    case 3://比較尾墩
                        tail();
                        break;
                }
            }
            function AI(AIarray, head, mid, tail) {//五枚>同花順>彩金鐵支>鐵支>彩金葫蘆>葫蘆>對子同花>同花>順子>彩金三條>三條>兩對<一對>烏龍
                //頭:衝三++
                //二道:彩金三條、彩金葫蘆、鐵支、同花順、彩金鐵支、五枚++
                //尾:同二道
                let test1 = 0, test2 = 0, test3 = 0, index = 0;
                //五枚
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                for (let j = 0; j < 16; j++) {
                    sys[AIarray[j] % 13] += 1;
                }               
                for (let j = 0; j < 13; j++) {
                    if (sys[j] == 5) {
                        for (let k = 0; k < 16; k++) {
                            if (AIarray[k] % 13 == j) {
                                if (test3 == 0) {
                                    test3 = 1;
                                    tail[index] = AIarray[k];
                                    index += 1;
                                    AIarray[k] = -1;
                                }
                                else if (test2 == 0) {
                                    test2 = 1;
                                    mid[index] = AIarray[k];
                                    index += 1;
                                    AIarray[k] = -1;
                                }
                            }
                        }
                    }
                }
                //同花順
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                for (let j = 0; j < 16; j++) {
                    if (AIarray[j] < 14) {
                        sys[0]++;
                    }
                    else if (AIarray[j] < 27) {
                        sys[1]++;
                    }
                    else if (AIarray[j] < 40) {
                        sys[2]++;
                    }
                    else {
                        sys[3]++;
                    }
                }   
                index = 0;
                let gold = 0;
                for (let j = 0; j < 4; j++) {
                    if (sys[j] > 4) {
                        switch (j) {
                            case 0://梅花
                                now = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                                for (let k = 0; k < 16; k++) {
                                    if (AIarray[k] <= 13) {
                                        now[AIarray[k] - 1] = 1;
                                    }
                                }
                                for (let k = 0; k < 9; k++) {
                                    i = 0;
                                    if (now[k] > 0 && now[k + 1] > 0 && now[k + 2] > 0 && now[k + 3] > 0 && now[k + 4] > 0) {
                                        i = 1;
                                        gold = k + 1;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 13) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                break;
                                            }
                                        }
                                        gold = k + 2;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 13) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 3;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 13) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 4;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 13) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 5;
                                        if (gold == 13) gold = 0;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 13) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                    }
                                    if (test3 == 0) {
                                        test3 = 1;
                                    }
                                    else if (test2 == 0) {
                                        test2 = 1;
                                    }
                                }
                                break;
                            case 1://磚塊
                                now = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                                for (let k = 0; k < 16; k++) {
                                    if (AIarray[k] <= 26 && AIarray[k] >= 14) {
                                        gold = AIarray[k] % 13;
                                        if (gold != 0) {
                                            now[gold - 1] = 1;
                                        }
                                        else {
                                            now[12] = 1;
                                        }
                                    }
                                }
                                for (let k = 0; k < 9; k++) {
                                    i = 0;
                                    if (now[k] > 0 && now[k + 1] > 0 && now[k + 2] > 0 && now[k + 3] > 0 && now[k + 4] > 0) {
                                        i = 1;
                                        gold = k + 1;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 26 && AIarray[l] >= 14) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 2;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 26 && AIarray[l] >= 14) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 3;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 26 && AIarray[l] >= 14) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 4;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 26 && AIarray[l] >= 14) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 5;
                                        if (gold == 13) gold = 0;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 26 && AIarray[l] >= 14) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                    }
                                    if (test3 == 0) {
                                        test3 = 1;
                                    }
                                    else if (test2 == 0) {
                                        test2 = 1;
                                    }
                                }
                                break;
                            case 2://愛心
                                now = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                                for (let k = 0; k < 16; k++) {
                                    if (AIarray[k] <= 39 && AIarray[k] >= 27) {
                                        gold = AIarray[k] % 13;
                                        if (gold != 0) {
                                            now[gold - 1] = 1;
                                        }
                                        else {
                                            now[12] = 1;
                                        }
                                    }
                                }
                                for (let k = 0; k < 9; k++) {
                                    i = 0;
                                    if (now[k] > 0 && now[k + 1] > 0 && now[k + 2] > 0 && now[k + 3] > 0 && now[k + 4] > 0) {
                                        i == 1;
                                        gold = k + 1;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 39 && AIarray[l] >= 27) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 2;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 39 && AIarray[l] >= 27) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 3;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 39 && AIarray[l] >= 27) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 4;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 39 && AIarray[l] >= 27) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 5;
                                        if (gold == 13) gold = 0;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] <= 39 && AIarray[l] >= 27) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                    }
                                    if (test3 == 0) {
                                        test3 = 1;
                                    }
                                    else if (test2 == 0) {
                                        test2 = 1;
                                    }
                                }
                                break;
                            case 3://黑桃
                                now = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                                for (let k = 0; k < 16; k++) {
                                    if (AIarray[k] >= 40) {
                                        gold = AIarray[k] % 13;
                                        if (gold != 0) {
                                            now[gold - 1] = 1;
                                        }
                                        else {
                                            now[12] = 1;
                                        }
                                    }
                                }
                                for (let k = 0; k < 9; k++) {
                                    i = 0;
                                    if (now[k] > 0 && now[k + 1] > 0 && now[k + 2] > 0 && now[k + 3] > 0 && now[k + 4] > 0) {
                                        i = 1;
                                        gold = k + 1;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] >= 40) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 2;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] >= 40) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 3;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] >= 40) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 4;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] >= 40) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                        gold = k + 5;
                                        if (gold == 13) gold = 0;
                                        for (let l = 0; l < 16; l++) {
                                            if (AIarray[l] % 13 == gold && AIarray[l] >= 40) {
                                                if (test3 == 0) {
                                                    tail[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                                else if (test2 == 0) {
                                                    mid[index] = AIarray[l];
                                                    index += 1;
                                                    AIarray[l] = -1;
                                                }
                                            }
                                        }
                                    }
                                    if (test3 == 0) {
                                        test3 = 1;
                                    }
                                    else if (test2 == 0) {
                                        test2 = 1;
                                    }
                                }
                                break;
                        }
                    }
                }
                //鐵支
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                for (let j = 0; j < 16; j++) {
                    sys[playerA[j] % 13] += 1;
                }
                for (let j = 0; j < 13; j++) {
                    if (sys[j] == 4) {
                        if (test3 == 0) {
                            test3 = -1;
                            for (let k = 0; k < 16; k++) {
                                if (playerA[k] % 13 == j) {
                                    tail[index] = AIarray[k];
                                    index += 1;
                                    AIarray[k] = -1;
                                }
                            }
                        }
                        else if (test2 == 0) {
                            test2 = -1;
                        }
                        
                        now[1] = j;
                        break;
                    }
                }
                //衝三判定
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //葫蘆
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //同花
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //順子
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //三條
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //兩對
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
                //一對
                sys = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                index = 0;
            }
            document.addEventListener("load", getdata(), false);//載入完網頁後讀數據
        </script>
    </body>
</html >
>>>>>>> Stashed changes
